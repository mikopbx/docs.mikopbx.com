# Пример реализации типового маршрута входящих вызовов

## Постановка задачи <a href="#postanovka_zadachi" id="postanovka_zadachi"></a>

Клиент звонит в компанию, звучит приветственное сообщение (голосовое приветствие).

Во время проигрывания голосового приветствия клиент может набрать любой внутренний номер, например, добавочный номер сотрудника или добавочный номер отдела.

После проигрывания голосового приветствия клиент может ввести с телефона цифры:

* **1** - вызов в этом случае направится в отдел продаж. **Отдел продаж** - это очередь вызовов, состоящая из двух агентов очереди (двух сотрудников). При звонке в отдел продаж вызов должен поступать на телефоны сотрудников одновременно. Если в течение 25 секунд никто из сотрудников не ответил на звонок клиента, то вызов должен направиться на мобильные номера сотрудников.
* **2** - вызов направится в отдел технической поддержки. **Отдел технической поддержки** - это очередь вызовов, состоящая из трех агентов очереди (трех сотрудников). Вызов должен поступать на любого свободного сотрудника (агента очереди). Если клиент ожидает ответ на свой звонок более 30 секунд, то вызов должен быть переведен на секретаря.

Если клиент ничего не ввел / некорректно набрал номер, то происходит повторное голосовое оповещение и клиент может снова ввести номер. Как только все попытки ввода корректного номера для клиента завершатся, то происходит переадресация вызова на секретаря.

## Решение <a href="#reshenie" id="reshenie"></a>

### Очереди вызовов <a href="#ocheredi_vyzovov" id="ocheredi_vyzovov"></a>

{% hint style="info" %}
Инструкции по очередям вызовов доступны по [ссылке](../../manual/telefoniya/call-queues.md).
{% endhint %}

Для нашего примера необходимо создать три очереди вызова:

1. Отдел продаж (мобильные номера сотрудников)
2. Отдел продаж (внутренние номера сотрудников)
3. Отдел технической поддержки

{% hint style="warning" %}
Предварительно необходимо создать внутренние учетные записи для сотрудников по [инструкции](../../manual/telefoniya/extensions.md) с указанием их мобильных номеров.
{% endhint %}

1. Перейдите в раздел **Телефония** → **Очереди вызовов**. Нажмите на кнопку «**Создать новую очередь**».

<figure><img src="../../.gitbook/assets/CallingQueue.png" alt=""><figcaption><p>Создание новой очереди </p></figcaption></figure>

2. Создаем очередь вызовов для отдела продаж (для **мобильных** номеров сотрудников).

<figure><img src="../../.gitbook/assets/1stCallingQueue.png" alt=""><figcaption><p>Очередь для отдела продаж(мобильные)</p></figcaption></figure>

3. Создаем очередь вызовов для отдела продаж (для **внутренних** номеров сотрудников).

<figure><img src="../../.gitbook/assets/2твtCallingQueue.png" alt=""><figcaption><p>Очередь для отдела продаж</p></figcaption></figure>

4. Указываем, что если в течение 25 секунд никто из сотрудников не ответил на звонок клиента, то вызов должен направиться на мобильные номера сотрудников.

<figure><img src="../../.gitbook/assets/2sttCallingQueueExtra.png" alt=""><figcaption><p>Сценарий в случае сбоя</p></figcaption></figure>

5. Создаем очередь вызовов для отдела технической поддержки.

<figure><img src="../../.gitbook/assets/3rdCallingQueue.png" alt=""><figcaption><p>Очередь для отдела технической поддержки</p></figcaption></figure>

### IVR-меню <a href="#ivr-menju" id="ivr-menju"></a>

{% hint style="info" %}
Инструкции по IVR-меню доступны по [ссылке](../../manual/telefoniya/ivr-menu.md).
{% endhint %}

1. &#x20;Перейдите в раздел **Телефония** → **IVR меню**. Нажмите на кнопку «**Создать новое IVR меню**».

<figure><img src="../../.gitbook/assets/NewIVRMenu.png" alt=""><figcaption><p>Создание нового IVR меню </p></figcaption></figure>

2. Указываем настройки IVR согласно нашему описанию.

<figure><img src="../../.gitbook/assets/IVRMenu (1).png" alt=""><figcaption><p>IVR Menu</p></figcaption></figure>

### Входящий маршрут <a href="#vxodjaschij_marshrut" id="vxodjaschij_marshrut"></a>

{% hint style="info" %}
Инструкции по входящим маршрутам доступны по [ссылке](../../manual/routing/incoming-routes.md).
{% endhint %}

1. На последнем шаге создаем входящий маршрут вызова для нашего провайдера. В разделе **Маршрутизация** → **Входящие маршруты** добавляем новое правило.

<figure><img src="../../.gitbook/assets/NewIncomingRoute.png" alt=""><figcaption><p>Раздел "Входящие маршруты"</p></figcaption></figure>

2. Заполните данные согласно шаблону:

<figure><img src="../../.gitbook/assets/IncomingRoute.png" alt=""><figcaption><p>Новое правило обработки входящих вызовов</p></figcaption></figure>
